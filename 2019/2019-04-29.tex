%%% Research Diary - Entry
\documentclass[11pt,a4paper]{article}

% Working date: The date this entry is describing. Not necessary the date of last edit.
\newcommand{\workingDate}{\textsc{2019 $|$ April $|$ 29}}

% Name and institution must preceed call to researchdiary.sty package
\newcommand{\userName}{Pierre BrÃ©chet}
\newcommand{\institution}{TUM}

% The guts and glory
\usepackage{research_diary}
\usepackage{usrcmd}
\bibliography{bibliography}

% Begin document.
% Use \logoPNG or \logoEPS. If compiling with PDFTeX, use \logoPNG
\begin{document}
% \logoPNG

{\Huge April 29}

\section*{Sinkhorn loss}

For $X=Y$, $\alpha \in \Mpo(X), \beta \in \Mpo(X)$, the Wasserstein loss based on the $\Wce$ is defined as:
\begin{align}
    \label{eqn:wasserstein-loss}
    \Wce(\alpha, \beta) &= \min_{\gamma} \set{ \int_{\XX} c(x, y) \d \gamma(x, y) + \eps \R(\gamma) \st \gamma \in \Pi(\alpha, \beta)} \\
                        &= \min_{\gamma} \int_{\XX} c(x, y) \d \gamma(x, y) + \eps \R(\gamma) + \delta_{\set{\alpha}}\paren{ \pf{\proj{1}}\gamma } + \delta_{\set{\beta}}\paren{\pf{\proj{2}}\gamma} + \delta_{+}(\gamma)
\end{align}

Then, the Sinkhorn loss is defined as:
\begin{equation}
    \SL(\alpha, \beta) = 2 \Wce(\alpha, \beta) - \Wce(\alpha, \alpha) - \Wce(\beta, \beta)
\end{equation}

The Sinkhorn ROTGAN is defined on the Sinkhorn primal loss
\begin{align}
    &\min_{G} \SL(\pf{G}{\zeta}, \nu)  \\
    \iff & \min_{G} 2 \Wce(\pf{G}{\zeta}, \nu) - \Wce(\pf{G}{\zeta}, \pf{G}{\zeta}) - \Wce(\nu, \nu)
\end{align}

\begin{rem}
    When performing the change of variable $\gammah = \pf{(G, \id)}\gamma$ in $\Wce(\mu, \nu)$
    \begin{align}
        &\min_{G}{\Lc(\pf{G}{\mu}, \nu)} &\\
        %\min_{G}{\int_{\ZX}{c(G(z), y)\d \gamma} &\\
            \iff &\min_{G} \min_{\gammab} \set{\int_{\XX}{c(x, y) \d \gammab(x, y)} \st \gammab \in \Gamma(\mu, \nu)} & \\
            \iff & \begin{array}{*2{>{\displaystyle}l}}
                \min_{G} \min_{\gammab} &\int_{\XX}{c(x, y) \d \gammab(x, y)}+ \delta_{+}(\gammab) \\
                                        &+ \delta_{\set{\mu}}(\pf{( \proj{1} )}{ \gammab })  + \delta_{\set{\nu}}(\pf{(\proj{2})}{\gammab})
            \end{array} \\
                \iff & \begin{array}{*2{>{\displaystyle}l}}
                    \min_{G} \min_{\gamma} &\int_{\XX}{c(x, y) \d \paren{\pf{\paren{G, \id}}{\gamma}}(z, x)}  + \delta_{+}\paren{ \pf{\paren{G, \id}}{\gamma} }\\
                                           &+ \delta_{\set{\mu}}\paren{ \pf{( \proj{1} )}{\pf{\paren{G,\id}}{\gamma}} }  + \delta_{\set{\nu}}\paren{ \pf{(\proj{2})}{\pf{\paren{G, \id}}{\gamma}} }
                \end{array} &\gammab = \pf{(G, \id)}{\gamma}\label{eqn:otgan-cv} \\
        % \min_{\gammah} \int_{\XX}{c(x, y) \d \gammah(x, y)} + \eps R(\gammah)
            \iff &\begin{array}{*2{>{\displaystyle}l}}
                \min_{G} \min_{\gamma} &\int_{\XX}{c(G(z), y) \d \gamma}(z, y) + \delta_{+}\paren{\gamma } \\
            % &+ \delta\set{\pf{(\projX}{\pf{(G, \id)}{\gamma}} = \pf{G}{\zeta}, \pf{\projY}{\pf{(G, \id)}{\gamma}} = \nu)}
              &+ \delta_{\set{\pf{G}{\zeta}}}\paren{ \pf{( \proj{1}
              )}{\pf{\paren{G,\id}}{\gamma}} }  + \delta_{\set{\nu}}\paren{ \pf{(\proj{2})}{\pf{\paren{G, \id}}{\gamma}} }
        \end{array}
    \end{align}
\end{rem}
% \begin{align}

% Using the extraction feature would correspond to solving
% \begin{align}
%     &\max_{F} \min_{G} \SL(\pf{F}{\pf{G}{\zeta}}, \pf{F}{\nu}) \\
%     \iff & \max_{F} \min_{G} 2 \Wce(\pf{F}{\pf{G}{\zeta}}, \pf{F}{\nu}) - \Wce(\pf{F}{\pf{G}{\zeta}}, \pf{F}{\pf{G}{\zeta}}) - \Wce(\pf{F}{\nu}, \pf{F}{\nu})
% \end{align}

\subsection{Informative Regularization}

\printbibliography{}
\end{document}
